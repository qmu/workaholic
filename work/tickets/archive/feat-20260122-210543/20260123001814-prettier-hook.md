# Move Prettier to PostToolUse Hook

## Overview

Remove manual prettier execution from commands and scripts. Instead, use a `PostToolUse` hook that automatically formats files after `Write` or `Edit` operations. This centralizes formatting logic and ensures consistent formatting without explicit instructions.

## Key Files

- `plugins/core/commands/commit.md` - Remove prettier instruction (line 14)
- `plugins/tdd/skills/archive-ticket/scripts/archive.sh` - Remove prettier step (lines 37-47)
- `plugins/core/hooks/hooks.json` - Create new hooks configuration file
- `plugins/core/hooks/format.sh` - Create formatting script

## Implementation Steps

1. Create `plugins/core/hooks/hooks.json` with PostToolUse hook:

   ```json
   {
     "description": "Automatic code formatting after file changes",
     "hooks": {
       "PostToolUse": [
         {
           "matcher": "Write|Edit",
           "hooks": [
             {
               "type": "command",
               "command": "${CLAUDE_PLUGIN_ROOT}/hooks/format.sh",
               "timeout": 30
             }
           ]
         }
       ]
     }
   }
   ```

2. Create `plugins/core/hooks/format.sh` script:

   - Read JSON input from stdin to get `tool_input.file_path`
   - Run `npx prettier --write` on the file if it exists
   - Exit 0 to not block the operation

3. Remove prettier instruction from `plugins/core/commands/commit.md`:

   - Delete line 14: `3. Run \`npx prettier --write\` on modified files to format before committing`
   - Renumber remaining steps

4. Remove prettier step from `plugins/tdd/skills/archive-ticket/scripts/archive.sh`:

   - Delete lines 37-47 (Step 1: Format modified files with prettier)
   - Renumber remaining steps in comments

5. Update `doc/specs/USER_GUIDE.md` and `doc/specs/CONFIGURATION.md`:
   - Change references from manual prettier to automatic hook-based formatting

## Considerations

- Hook runs on every Write/Edit, so script must be fast and fail gracefully
- Use `2>/dev/null || true` pattern to not fail if prettier isn't installed
- The `${CLAUDE_PLUGIN_ROOT}` variable points to the plugin directory
- Script needs to parse JSON stdin to extract file path
